<%- model_class = Event -%>
<div class="page-header">
  <h1>
    <%=t '.title', :default => model_class.model_name.human.titleize %>
    <% if user_signed_in? %>
      <span class="pull-right">
        <% if current_user.organizing_events.include?(@event) %>
          <% if can? :edit, @event %>
              <%= link_to t('.edit', :default => t("helpers.links.edit")),
                          edit_event_path(@event), :class => 'btn btn-default' %>
          <% end %>
          <% if can? :destroy, @event %>
              <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                          event_path(@event),
                          :method => 'delete',
                          :data => {:confirm => t('.confirm', :default => t("helpers.links.confirm"))},
                          :class => 'btn btn-danger' %>
          <% end %>
        <% end %>
      </span>
    <% end %>
  </h1>
</div>

<dl class="dl-horizontal">
  <% [:name, :description, :discipline, :game_mode, :max_teams, :deadline, :startdate, :enddate].each do |attribute| %>
      <dt><strong><%= model_class.human_attribute_name(attribute) %>:</strong></dt>
      <dd><%= @event.send attribute %></dd>
  <% end %>
</dl>

<div class="table-responsive">
  <h3><%= t("events.show.participants") %></h3>
  <table class="table">
    <% if @event.single_player? %>
      <thead><tr><th><%=t '.title', :default => User.model_name.human.titleize %></th></tr></thead>
      <tbody>
        <% @event.participants.each do |participant| %>
          <tr><td><%= participant.name %></td></tr>
        <% end %>
      </tbody>
    <% else %>
      <thead><tr><%=t '.title', :default => Team.model_name.human.titleize %></tr></thead>
      <tbody>
        <% @event.teams.each do |team| %>
          <tr><td><%= link_to team.name, team_path(team), id: team.name %></td></tr>
        <% end %>
      </tbody>
    <% end %>
  </table>
</div>

<%# Only rendering the schedule if the event is a league (schedule generation isn't defined for any other event type yet)%>
<%= if @event.is_a? League
      link_to t('.to_schedule'),
              event_schedule_path(@event),
              :class => 'btn btn-default'
    end%>

<%= link_to t('.to_overview'),
            event_overview_path(@event), :class => 'btn btn-default' %>

<%# app/helpers/button_helper.rb %>
<%= back_btn %>
<% if can? :leave, @event %>
    <% if @event.single_player? %>
      <%= link_to t('.leave', :default => t("helpers.links.leave")),
                  leave_event_path(@event),
                  :method => :put,
                  :class => 'btn btn-default',
                  id: :leave_event_button %>
    <% else %>
      <%= link_to t('.leave', :default => t("helpers.links.leave")),
                  leave_event_path(@event),
                  :method => :put,
                  :class => 'btn btn-default',
                  disabled: (not @event.ownes_participating_teams?(current_user)),
                  id: :leave_event_button %>
  <% end %>
  <%= t('events.participating') %>
<% end %>
<% if can? :join, @event%>
  <% if @event.single_player? %>
    <%= link_to t('.join', :default => t("helpers.links.join")),
                join_event_path(@event),
                :method => :put,
                :class => 'btn btn-default',
                id: :join_event_button %>
  <% else %>
    <%= link_to t('.join', :default => t("helpers.links.join")),
                team_join_path(@event),
                remote: true, data: {toggle: "modal", target: "modal-window"},
                class: 'btn btn-default',
                id: :join_event_button %>
  <% end %>
<% end %>

<div id="modal-window" class="modal fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
    </div>
  </div>
</div>